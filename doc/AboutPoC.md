About proof of capacity
====
PoC is an mining algorithm by using storage media such as HDD.
[BurstCoin](https://burstwiki.org/wiki/Main_Page) is famous for a currency that implement PoC.

Tools
----
* Rust library [bc4py_plotter](http://github.com/namuyan/bc4py_plotter/)
* Python extension [bc4py_extension](https://github.com/namuyan/bc4py_extension/)

Algorithm
----
1. We generate seed and push hash0 to top.
    ```text
    +---------+----------------+----------------------+
    | hash0   | Address        | nonce                |
    | 64bytes | UTF-8 40 bytes | little endian 4bytes |
    +---------+----------------+----------------------+
     
        ^     |                                       |
        |     +-------------+ blake2bp +--------------+
        |                        |
        |                        v
        |                   +----+-----+
        +------------------ |  hash0   |
                            +----------+
    ```
2. We generate hashN and push to top. source of hashN is only the last 1024 generated bytes.
    ```text
    +---------+---------+     +---------+----------------+----------------------+
    | hashN   | hashN-1 |     | hash0   | Address        | nonce                |
    | 64bytes | 64bytes | XXX | 64bytes | UTF-8 40 bytes | little endian 4bytes |
    +---------+---------+     +---------+----------------+----------------------+
     
        ^     |                                                    |
        |     +----- max size 1024bytes ------+ blake2bp +---//----+
        |                                          |
        |                                          v
        |                                     +----+-----+
        +------------------------------------ |  hashN   |
                                              +----------+
    ```
3. Once we have created 8192 hashes we are now going to make a Final hash.
    ```text
    +----------+----------+     +----------+
    | hash8191 | hash8190 |     | hash0    |
    | 64bytes  | 64bytes  | XXX | 64bytes  |
    +----------+----------+     +----------+
     
    |                                      |
    +---------+ blake2bp  +----------------+
                   |
                   v
              +----+------+
              | finalHash |
              +-----------+
    ```
4. All hashes XOR with the final hash and split to 2 scopes.
    ```text
    +-------------------------+     +-------------------------+
    |         hash0           |     |       hash8191          |
    |         64bytes         | XXX |       64bytes           |
    +-------------------------+     +-------------------------+
                  |              |             |
                 XOR            XOR           XOR
                  |              |             |
                  v              v             v
    +-------------------------+     +-------------------------+
    |         hash'0          |     |       hash'8191         |
    |         64bytes         | XXX |       64bytes           |
    +-------------------------+     +-------------------------+
             |           |       |       |          |
             |           |       |       |          |
             v           v       v       v          v
    +-------------------------+     +-------------------------+
    |  scope0    |  scope1    |     | scope16382 | scope16383 |
    |  32bytes   |  32bytes   | XXX | 32bytes    | 32bytes    |
    +-------------------------+     +-------------------------+
    scopeHash
    ```
5. We get a scope index by `int(previousHash) % 16384`  and define indexed ths hash a scopeHash.
6. We generate a pre-workHash from 3 params. Then, we define upper side of 32 bytes is workHash.
    ```text
    +----------------------+ +----------------------+ +----------------------+
    | blocktime            | | scopeHash            | | previousHash         |
    | little endian 4bytes | | 32bytes              | | 32bytes              |
    +----------------------+ +----------------------+ +----------------------+
     
    |                                                                        |
    +----------------------------+ blake2bp +--------------------------------+
                                      v
                               +----------------------+
                               | pre workHash 64bytes |
                               +---+------------------+
                                   v
                               +----------+
                               | workHash |
                               | 32bytes  |
                               +----------+
    ```

References
----
* [Technical information to create plot files](https://burstwiki.org/wiki/Technical_information_to_create_plot_files)
* [Technical information about mining and block forging](https://burstwiki.org/wiki/Technical_information_about_mining_and_block_forging)
